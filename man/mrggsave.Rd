% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mrggsave.R
\name{mrggsave}
\alias{mrggsave}
\alias{mrggsave.ggplot}
\alias{mrggsave.ggmatrix}
\alias{mrggsave.gList}
\alias{mrggsave.gtable}
\alias{mrggsave.trellis}
\alias{mrggsave.patchwork}
\alias{mrggsave.list}
\alias{mrggsave.gg}
\alias{mrggsave.gTree}
\alias{mrgglabel}
\alias{mrggsave_common}
\title{Label, arrange, and save graphics}
\usage{
mrggsave(x, ...)

\method{mrggsave}{ggplot}(x, ..., ypad = 2, arrange = FALSE, ncol = 1, onefile = TRUE)

\method{mrggsave}{ggmatrix}(x, ..., ypad = 4, arrange = FALSE, onefile = TRUE)

\method{mrggsave}{gList}(...)

\method{mrggsave}{gtable}(...)

\method{mrggsave}{trellis}(x, ..., ypad = 3, arrange = FALSE, ncol = 1, onefile = TRUE)

\method{mrggsave}{patchwork}(x, ...)

\method{mrggsave}{list}(x, ..., arrange = FALSE, use_names = FALSE)

\method{mrggsave}{gg}(x, ...)

\method{mrggsave}{gTree}(x, ...)

mrgglabel(..., draw = FALSE, .save = FALSE)

mrggsave_common(
  x,
  script = getOption("mrg.script", NULL),
  tag = NULL,
  width = 5,
  height = 5,
  stem = "Rplot",
  dir = getOption("mrggsave.dir", "../deliv/figure"),
  prefix = NULL,
  onefile = TRUE,
  arrange = FALSE,
  draw = FALSE,
  .save = TRUE,
  ypad = 3,
  labsep = "\\n",
  pre_label = NULL,
  post_label = NULL,
  fontsize = 7,
  textGrob.x = 0.01,
  textGrob.y = unit(0.1, "in"),
  just = c("left", "bottom"),
  dev = getOption("mrggsave.dev", "pdf"),
  res = 150,
  units = "in",
  position = getOption("mrggsave.position", "default"),
  labeller = getOption("mrggsave.label.fun", label.fun),
  envir = sys.frame(-1),
  ...
)
}
\arguments{
\item{x}{an object or list of objects of class \code{gg}}

\item{...}{other arguments passed to \code{mrggsave_common} and then
on to \code{\link{pdf}} and \code{arrangeGrob}}

\item{ypad}{integer number of newlines to separate annotation
from x-axis title}

\item{arrange}{logical; if \code{TRUE}, arrange the ggplot objects on a
single page with \code{arrangeGrob}}

\item{ncol}{passed to \code{\link{arrangeGrob}}}

\item{onefile}{passed to \code{\link{pdf}}}

\item{use_names}{if \code{TRUE}, the names from a list of plots will be used
as the stems for output file names}

\item{draw}{if \code{TRUE}, the plot is drawn using \code{\link{draw_newpage}}}

\item{.save}{logical; if \code{FALSE}, return the labeled objects}

\item{script}{the name of the script generating the \code{gg} objects}

\item{tag}{if specified, stem is overwritten by pasting \code{script}
and \code{tag} together}

\item{width}{passed to \code{\link{pdf}}; should be less than 5 in.
for portrait figure}

\item{height}{passed to \code{\link{pdf}}; should be less than 7 in.
for portrait figure}

\item{stem}{to form the name of the output \code{.pdf} file}

\item{dir}{output directory for \code{.pdf} file}

\item{prefix}{gets prepended to the output file path in the Source
graphic, label}

\item{labsep}{character separator (or newline) for Source code and
Source graphic labels}

\item{pre_label}{text to include before annotation; separate lines prior
to Source code label; see details}

\item{post_label}{text to include after annotation; separate lines after
Source graphic; see details}

\item{fontsize}{for Source graphic and Source code labels}

\item{textGrob.x}{passed to \code{textGrob} (as \code{x})}

\item{textGrob.y}{passed to \code{textGrob} (as \code{y})}

\item{just}{passed to \code{textGrob} (as \code{just})}

\item{dev}{one or more devices to use; can pass a character vector or a
comma-separated string (e.g. \code{c("pdf", "png")} or \code{"pdf,png"})}

\item{res}{passed to \code{\link{png}}}

\item{units}{passed to \code{\link{png}}}

\item{position}{force the graphic annotation to locate to the left or right}

\item{labeller}{a function that creates the plot annotation; the function
should receive a single argument (\code{x}) which is an environment
containing various items that might go into the label; pass `NULL` to
omit the label on the plot}

\item{envir}{environment to be used for string interpolation in
stem and tag}
}
\description{
Save plot objects as .pdf file after labeling with Source graphic and
Source code labels.
}
\details{
Methods are provided for \code{ggplot} output, \code{lattice}
output, and \code{ggmatrix} objects (produced by
\code{GGally::ggpairs}).  Either a single plot object
or a list of objects can be passed in.  If a list of objects
are passed in, the plots may be written to a single file (default)
or multiple files (if \code{onefile} is \code{FALSE}).
Alternatively, \code{ggplots} and \code{lattice plots}
can be arranged on a single page when
\code{arrange} is \code{TRUE}.  \code{ggmatrix} objects
cannot be arranged.  An error is generated if different
object types are passed in a single list.

By default, the output file name is generated from
the script name and the value in \code{tag}.  For example,
when the script is named \code{vpc_figures} and the tag
is passed as \code{_by_dose_group}, the output file name
will be \code{vpc_figures_by_dose_group.pdf}.  Alternatively,
the user can specify the complete stem of the file
name with the \code{stem} argument.

When \code{.save} is \code{FALSE}, \code{mrggsave}
always returns a list of table grobs.  If a single
plot was passed, the return value in this case
is a list of length 1.

\code{mrgglabel} calls \code{mrggsave} and
neither draws nor saves the plot, but
returns the annotated plots as table grob.

\code{pre_label} and \code{post_label} are collapsed with newline if
supplied by the user, allowing multiple lines to be added before or
after the standard annotation.
}
\examples{
data(Theoph)
require(ggplot2)

x <- runif(1000,10,100)
y <- 0.3*x + rnorm(length(x),0,20)
data <- data.frame(x = x, y = y)

Script <- "example.R"

# NOTE: see default value for dir argument, which should be appropriate
# for project work

# Changing it here only for the example
options(mrggsave.dir = tempdir())


p1 <- ggplot(data=Theoph) +
  geom_line(aes(x=Time, y=conc, group=Subject))

p2 <- ggplot(data=Theoph) +
  geom_line(aes(x=Time, y=conc)) +
  facet_wrap(~Subject)

mrggsave(p1, Script, "_plot1")

\dontrun{
mrggsave(p2, Script, "_plot2")
}

mrggsave(list(p1,p2), Script, "both_plots")

\dontrun{
mrggsave(list(p1,p2), Script, "separate_files", onefile=FALSE)
}

mrggsave(p1, Script, "different_shape", width=10, height=4)

\dontrun{
mrggsave(list(p1,p2), Script, "onepage", arrange=TRUE, ncol=2)

stopifnot(require(GGally))

p3 <- ggpairs(data)

mrggsave(p3, Script, "ggally_plot")
}
}
\seealso{
\code{\link{mrggdraw}}, \code{\link{mrggsave_list}}
}
